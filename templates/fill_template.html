{% extends "base.html" %}
{% block title %}Create {{ template.name }}{% endblock %}

{% block content %}
<div class="main-container">

  <h3 class="text-center mb-2">{{ template.name }}</h3>
  <p class="text-center text-muted">Fill details and upload images</p>

  <form method="POST" enctype="multipart/form-data">

    {% for f in fields %}

      {% if f.field_type == "text" %}
        <label class="mt-3">{{ f.field_name|capitalize }}</label>
        <input class="form-control" name="{{ f.field_name }}" required>
      {% endif %}

      {% if f.field_type == "image" %}
        <label class="mt-3">{{ f.field_name|capitalize }}</label>

        <div class="card p-3 text-center">
          {% if session.get('preview_info', {}).get('asset_map', {}).get(f.field_name) %}
            <img src="{{ url_for('view_preview',
                filename=session.preview_info.asset_map[f.field_name].split('/')[-1]) }}"
                 class="img-fluid rounded mb-2">
            <a href="{{ url_for('crop_image',
                template_id=template.id, field=f.field_name) }}"
               class="btn btn-outline-primary btn-sm">
              Re-Crop Image
            </a>
          {% else %}
            <a href="{{ url_for('crop_image',
                template_id=template.id, field=f.field_name) }}"
               class="btn btn-outline-primary">
              Add & Crop Image
            </a>
          {% endif %}
        </div>
      {% endif %}

    {% endfor %}

    <button class="btn btn-primary w-100 mt-4">
      Generate Preview â†’
    </button>

  </form>
</div>
{% endblock %}

