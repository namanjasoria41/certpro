{% extends "base.html" %}

{% block title %}Builder — {{ template.name }}{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/builder.css') }}">
{% endblock %}

{% block content %}

<div class="builder-container">

    <!-- LEFT TOOLBAR -->
    <div class="builder-toolbar">
        <button class="tool-btn" onclick="addText()">Text</button>
        <button class="tool-btn" onclick="addImagePlaceholder()">Image Box</button>
        <button class="tool-btn" onclick="addCirclePlaceholder()">Circle Image</button>
        <button class="tool-btn" onclick="addRectangle()">Rect</button>
        <button class="tool-btn" onclick="addCircle()">Circle</button>

        <button class="tool-btn" onclick="undo()">Undo</button>
        <button class="tool-btn" onclick="redo()">Redo</button>

        <button class="tool-btn" onclick="lockSelected()">Lock</button>
        <button class="tool-btn" onclick="unlockSelected()">Unlock</button>
        <button class="tool-btn" onclick="hideSelected()">Hide</button>
        <button class="tool-btn" onclick="showAll()">Show All</button>

        <button class="tool-btn delete-btn" onclick="deleteSelected()">Delete</button>
    </div>

    <!-- CANVAS AREA -->
    <div class="builder-canvas-wrapper">
        <div id="builderCanvasContainer">
            <canvas id="builderCanvas"></canvas>
        </div>

        <div class="zoom-controls">
            <button onclick="zoomOut()">−</button>
            <span id="zoomValue">100%</span>
            <button onclick="zoomIn()">+</button>
        </div>
    </div>

    <!-- RIGHT PANEL -->
    <div class="builder-properties">
        <h5>Field Properties</h5>

        <label>Field Name</label>
        <input id="propName" onchange="updateName()">

        <label>Font Size</label>
        <input id="propFontSize" type="number" onchange="updateFontSize()">

        <label>Color</label>
        <input id="propColor" type="color" onchange="updateColor()">

        <h5 class="mt-4">Layers</h5>
        <ul id="layerList" class="layer-list"></ul>

        <button class="save-btn" onclick="saveTemplate()">Save Template</button>
    </div>

</div>

{% endblock %}

{% block extra_js %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.2.4/fabric.min.js"></script>

<script>
    const TEMPLATE_ID = {{ template.id }};
    const TEMPLATE_URL = "{{ template_image_url }}";
    const EXISTING_FIELDS = {{ fields | tojson }};
</script>

<script src="{{ url_for('static', filename='js/builder.js') }}"></script>
{% endblock %}

