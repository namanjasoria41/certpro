{% extends "base.html" %}

{% block title %}Builder â€” {{ template.name }}{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/builder.css') }}">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
{% endblock %}

{% block content %}

<div class="builder-wrapper">

  <!-- TOP BAR -->
  <div class="builder-topbar">
    <span>Editing: {{ template.name }}</span>
    <button class="save-btn" onclick="saveTemplate()">Save</button>
  </div>

  <!-- CANVAS -->
  <div class="builder-canvas-area">
    <canvas id="builderCanvas"></canvas>
  </div>

  <!-- TOOLBAR -->
  <div class="builder-toolbar">
    <button onclick="addText()">Text</button>
    <button onclick="addRect()">Rect</button>
    <button onclick="toggleProperties()">Props</button>
  </div>

  <!-- PROPERTIES -->
  <div id="propertiesPanel" class="drawer-panel">
    <input id="propName" placeholder="Field name" onchange="updateName()">
    <input id="propFontSize" type="number" placeholder="Font size" onchange="updateFontSize()">
    <input id="propColor" type="color" onchange="updateColor()">
    <button class="delete-btn" onclick="deleteSelected()">Delete</button>
  </div>

</div>

{% endblock %}

{% block extra_js %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.2.4/fabric.min.js"></script>
<script>
  const TEMPLATE_ID = {{ template.id }};
  const TEMPLATE_IMAGE = "{{ template_image_url }}";
  const EXISTING_FIELDS = {{ fields | tojson }};
</script>
<script src="{{ url_for('static', filename='js/builder.js') }}"></script>
{% endblock %}

