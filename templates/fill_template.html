{% extends "base.html" %}

{% block title %}Fill Template - {{ template.name }}{% endblock %}

{% block content %}
<div class="container mt-4">
  <h2 class="mb-4">Fill Template: {{ template.name }}</h2>

  <div class="row">
    <div class="col-md-7 mb-4">
      <div class="card">
        <div class="card-header">
          Template Preview
        </div>
        <div class="card-body text-center">
          <img src="{{ url_for('static', filename='templates/' + template.image_path) }}"
               class="img-fluid" alt="{{ template.name }}">
        </div>
      </div>
    </div>

    <div class="col-md-5 mb-4">
      <div class="card">
        <div class="card-header">
          Fill Certificate Data
        </div>
        <div class="card-body">
          <p class="mb-2">
            <strong>Price:</strong> ₹ {{ "%.2f"|format(template.price or 0) }}<br>
            <strong>Your Wallet:</strong> ₹ {{ "%.2f"|format(current_user.wallet_balance or 0) }}
          </p>

          {% if current_user.wallet_balance < template.price %}
          <div class="alert alert-warning">
            Your wallet balance is low. Please <a href="{{ url_for('wallet') }}">add money</a> to generate this certificate.
          </div>
          {% endif %}

          <form method="POST">
            {% for field in fields %}
            <div class="mb-3">
              <label class="form-label">{{ field.name }}</label>
              <input type="text"
                     name="{{ field.name }}"
                     class="form-control"
                     placeholder="Enter {{ field.name }}"
                     required>
            </div>
            {% endfor %}

            <button type="submit"
                    class="btn btn-primary"
                    {% if current_user.wallet_balance < template.price %}disabled{% endif %}>
              Generate Certificate
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
